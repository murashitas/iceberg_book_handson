## メタデータファイルのフィールドと関連オブジェクト
### メタデータファイルのフィールド
| v1 | v2 | v3 | フィールド | 型 | 説明 |
|:---:|:---:|:---:|:------------|:---|:-----|
| 必須 | 必須 | 必須 | format-version | integer | フォーマットのバージョン番号。現在の仕様では1または2。実装は、テーブルのバージョンがサポートされているバージョンより高い場合、例外をスローする必要がある。 |
| オプション | 必須 | 必須 | table-uuid | UUID | テーブル作成時に生成されるテーブルを識別するUUID。実装は、メタデータを更新した後、テーブルのUUIDが期待されるUUIDと一致しない場合、例外をスローする必要がある。 |
| 必須 | 必須 | 必須 | location | string | テーブルのベースロケーション。データファイル、マニフェストファイル、テーブルメタデータファイルの保存場所を決定するために書き込み側で使用される。 |
| 必須 | 必須 |  | last-sequence-number | long | テーブルに割り当てられた最高シーケンス番号。テーブル内のスナップショットの順序を追跡する単調増加する値。 |
| 必須 | 必須 | 必須 | last-updated-ms | timestamp | テーブルが最後に更新されたUnixエポックからのミリ秒単位のタイムスタンプ。各テーブルメタデータファイルは、書き込み直前にこのフィールドを更新する必要がある。 |
| 必須 | 必須 | 必須 | last-column-id | integer | テーブルに割り当てられた最高列ID。スキーマを進化させる際に、列が常に未使用のIDを割り当てられることを保証するために使用される。 |
| 必須 |  |  | schema | object | テーブルの現在のスキーマ。(非推奨：代わりにschemasとcurrent-schema-idを使用) |
| オプション | 必須 | 必須 | schemas | list<schema> | schema-idを持つオブジェクトとして保存されるスキーマのリスト。 |
| オプション | 必須 | 必須 | current-schema-id | integer | テーブルの現在のスキーマのID。 |
| 必須 |  |  | partition-spec | object | テーブルの現在のパーティション仕様（フィールドのみとして保存）。書き込み側でデータをパーティション化するために使用されるが、読み取り時にはマニフェストファイルに保存された仕様が使用されるため、読み取りには使用されない。(非推奨：代わりにpartition-specsとdefault-spec-idを使用) |
| オプション | 必須 | 必須 | partition-specs | list<spec> | 完全なパーティション仕様オブジェクトとして保存されるパーティション仕様のリスト。 |
| オプション | 必須 | 必須 | default-spec-id | integer | 書き込み側がデフォルトで使用すべき「現在の」仕様のID。 |
| オプション | 必須 | 必須 | last-partition-id | integer | テーブルのすべてのパーティション仕様にわたって割り当てられた最高パーティションフィールドID。仕様を進化させる際に、パーティションフィールドが常に未使用のIDを割り当てられることを保証するために使用される。 |
| オプション | オプション | オプション | properties | map<string, string> | テーブルプロパティの文字列から文字列へのマップ。読み書きに影響を与える設定を制御するために使用され、任意のメタデータには使用されない。例えば、commit.retry.num-retriesはコミットの再試行回数を制御するために使用される。 |
| オプション | オプション | オプション | current-snapshot-id | long | 現在のテーブルスナップショットのID。refsのメインブランチの現在のIDと同じである必要がある。 |
| オプション | オプション | オプション | snapshots | list<snapshot> | 有効なスナップショットのリスト。有効なスナップショットとは、すべてのデータファイルがファイルシステムに存在するスナップショット。データファイルは、それが最後にリストされたスナップショットがガベージコレクトされるまで、ファイルシステムから削除してはならない。 |
| オプション | オプション | オプション | snapshot-log | list<log_entry> | テーブルの現在のスナップショットの変更を記録するタイムスタンプとスナップショットIDのペアのリスト（オプション）。current-snapshot-idが変更されるたびに、last-updated-msと新しいcurrent-snapshot-idを含む新しいエントリを追加する必要がある。スナップショットが有効なスナップショットのリストから期限切れになった場合、期限切れになったスナップショットより前のすべてのエントリを削除する必要がある。 |
| オプション | オプション | オプション | metadata-log | list<log_entry> | テーブルの以前のメタデータファイルの変更を記録するタイムスタンプとメタデータファイルロケーションのペアのリスト（オプション）。新しいメタデータファイルが作成されるたびに、以前のメタデータファイルロケーションの新しいエントリをリストに追加する必要がある。テーブルは、コミット後に最も古いメタデータログエントリを削除し、最新のエントリの固定サイズログを保持するように構成できる。 |
| オプション | 必須 | 必須 | sort-orders | list<order> | 完全なソート順オブジェクトとして保存されるソート順のリスト。 |
| オプション | 必須 | 必須 | default-sort-order-id | integer | テーブルのデフォルトソート順ID。書き込み側で使用される可能性があるが、読み取り時にはマニフェストファイルに保存された仕様が使用されるため、読み取りには使用されない。 |
| オプション | オプション |  | refs | map<string, ref> | スナップショット参照のマップ。マップキーはテーブル内の一意のスナップショット参照名で、マップ値はスナップショット参照オブジェクト。refsマップがnullの場合でも、current-snapshot-idを指すメインブランチ参照は常に存在する。 |
| オプション | オプション | オプション | statistics | list<statistic> | テーブル統計のリスト（オプション）。 |
| オプション | オプション | オプション | partition-statistics | list<statistic> | パーティション統計のリスト（オプション）。 |
|  |  | 必須 | next-row-id | long | 割り当てられたすべての行IDより大きい値。次のスナップショットのfirst-row-idとなる。行リネージに使用。 |
|  |  | オプション | encryption-keys | list<key> | テーブル暗号化に使用される暗号化キーのリスト（オプション）。 |

### スキーマ（schemas）オブジェクトのフィールド

| v1 | v2 | v3 | フィールド | 型 | 説明 |
|:---:|:---:|:---:|:------------|:---|:-----|
| オプション | 必須 | 必須 | schema-id | integer | スキーマを識別する一意のID |
| オプション | オプション | オプション | identifier-field-ids | list<integer> | 行を識別するプリミティブフィールドのIDのリスト |
| 必須 | 必須 | 必須 | fields | list<field> | スキーマのフィールドのリスト |

#### フィールド（field）オブジェクトの構造

| v1 | v2 | v3 | フィールド | 型 | 説明 |
|:---:|:---:|:---:|:------------|:---|:-----|
| 必須 | 必須 | 必須 | id | integer | テーブルスキーマ内で一意のフィールドID |
| 必須 | 必須 | 必須 | name | string | フィールド名 |
| 必須 | 必須 | 必須 | required | boolean | フィールドが必須（true）またはオプション（false）かを示す |
| 必須 | 必須 | 必須 | type | type object/string | フィールドのデータ型 |
| オプション | オプション | オプション | doc | string | フィールドの説明やコメント |
|  |  | オプション | initial-default | value | フィールドが追加される前に書かれたレコードに使用されるデフォルト値 |
|  |  | オプション | write-default | value | フィールドが追加された後、値が提供されない場合に使用されるデフォルト値 |

##### ネスト型

###### Struct型
| フィールド | 型 | 説明 |
|:------------|:---|:-----|
| type | string | "struct" |
| fields | list<field> | 構造体のフィールドのリスト |

###### List型
| フィールド | 型 | 説明 |
|:------------|:---|:-----|
| type | string | "list" |
| element-id | integer | 要素のID（テーブルスキーマ内で一意） |
| element-required | boolean | 要素がnullを許可するか |
| element | type object/string | 要素の型 |

###### Map型
| フィールド | 型 | 説明 |
|:------------|:---|:-----|
| type | string | "map" |
| key-id | integer | キーのID（テーブルスキーマ内で一意） |
| key | type object/string | キーの型 |
| value-id | integer | 値のID（テーブルスキーマ内で一意） |
| value-required | boolean | 値がnullを許可するか |
| value | type object/string | 値の型 |

##### プリミティブ型

| 型 | v3追加 | 説明 |
|:------------|:---:|:-----|
| unknown | ✓ | より具体的な型が不明な場合のデフォルト/null列型 |
| boolean |  | true または false |
| int |  | 32ビット符号付き整数 |
| long |  | 64ビット符号付き整数 |
| float |  | 32ビットIEEE 754浮動小数点数 |
| double |  | 64ビットIEEE 754浮動小数点数 |
| decimal(P,S) |  | 固定小数点数：精度P、スケールS |
| date |  | タイムゾーンや時刻なしのカレンダー日付 |
| time |  | マイクロ秒精度の時刻、日付・タイムゾーンなし |
| timestamp |  | マイクロ秒精度のタイムスタンプ、タイムゾーンなし |
| timestamptz |  | マイクロ秒精度のタイムスタンプ、タイムゾーン付き |
| timestamp_ns | ✓ | ナノ秒精度のタイムスタンプ、タイムゾーンなし |
| timestamptz_ns | ✓ | ナノ秒精度のタイムスタンプ、タイムゾーン付き |
| string |  | UTF-8エンコードの任意長文字列 |
| uuid |  | 汎用一意識別子 |
| fixed(L) |  | 長さLの固定長バイト配列 |
| binary |  | 任意長バイト配列 |
| variant | ✓ | 半構造化データを格納する値 |
| geometry(C) | ✓ | OGC地理空間要素、CRS Cでパラメータ化 |
| geography(C,A) | ✓ | OGC地理空間要素、CRS Cとエッジ補間アルゴリズムAでパラメータ化 |

##### デフォルト値の制約
| 制約 | 説明 |
|:-----|:-----|
| initial-default設定時 | フィールド追加時に設定され、変更不可 |
| write-default設定時 | フィールド追加時に設定され、変更可能 |
| 必須フィールド追加時 | initial-defaultとwrite-defaultの両方を非null値に設定する必要がある |
| オプションフィールド追加時 | デフォルト値はnullでも可、明示的に設定すべき |
| unknown/variant/geometry/geography型 | デフォルト値は必ずnull |

### パーティション仕様（partition-specs）オブジェクト
#### パーティション仕様のメタデータ
| v1 | v2 | v3 | フィールド | 型 | 説明 |
|:---:|:---:|:---:|:------------|:---|:-----|
| オプション | 必須 | 必須 | spec-id | integer | パーティション仕様を識別する一意のID |
| 必須 | 必須 | 必須 | fields | list<partition-field> | パーティションフィールドのリスト |
#### パーティションフィールド（partition-field）
| v1 | v2 | v3 | フィールド | 型 | 説明 |
|:---:|:---:|:---:|:------------|:---|:-----|
| 必須 | 必須 | オプション | source-id | integer | ソース列のID（単一引数変換の場合） |
|  |  | オプション | source-ids | list<integer> | ソース列のIDリスト（複数引数変換の場合） |
| オプション | 必須 | 必須 | field-id | integer | パーティションフィールドのID（パーティション仕様内で一意） |
| 必須 | 必須 | 必須 | name | string | パーティションフィールド名 |
| 必須 | 必須 | 必須 | transform | string | 適用される変換（例：day、bucket[16]、truncate[20]） |
### ソート順（sort-orders）オブジェクト
#### ソート順のメタデータ
| v1 | v2 | v3 | フィールド | 型 | 説明 |
|:---:|:---:|:---:|:------------|:---|:-----|
| 必須 | 必須 | 必須 | order-id | integer | ソート順を識別する一意のID（0は未ソートを示す） |
| 必須 | 必須 | 必須 | fields | list<sort-field> | ソートフィールドのリスト |
#### ソートフィールド（sort-field）
| v1 | v2 | v3 | フィールド | 型 | 説明 |
|:---:|:---:|:---:|:------------|:---|:-----|
| 必須 | 必須 | 必須 | transform | string | ソートに使用される変換 |
| 必須 | 必須 | オプション | source-id | integer | ソース列のID（単一引数変換の場合） |
|  |  | オプション | source-ids | list<integer> | ソース列のIDリスト（複数引数変換の場合） |
| 必須 | 必須 | 必須 | direction | string | ソート方向（"asc" または "desc"） |
| 必須 | 必須 | 必須 | null-order | string | null値の順序（"nulls-first" または "nulls-last"） |
### スナップショット（snapshots）オブジェクト
| v1 | v2 | v3 | フィールド | 型 | 説明 |
|:---:|:---:|:---:|:------------|:---|:-----|
| 必須 | 必須 | 必須 | snapshot-id | long | スナップショットを識別する一意のID |
| オプション | オプション | オプション | parent-snapshot-id | long | 親スナップショットのID（親がない場合は省略） |
|  | 必須 | 必須 | sequence-number | long | 変更順序を追跡する単調増加値 |
| 必須 | 必須 | 必須 | timestamp-ms | long | スナップショット作成時のタイムスタンプ（Unixエポックからのミリ秒） |
| オプション | 必須 | 必須 | manifest-list | string | マニフェストリストファイルの場所 |
| オプション |  |  | manifests | list<string> | マニフェストファイルの場所リスト（manifest-listがある場合は省略） |
| オプション | 必須 | 必須 | summary | map<string, string> | スナップショットのサマリー情報（operationフィールドは必須） |
| オプション | オプション | オプション | schema-id | integer | スナップショット作成時のスキーマID |
|  |  | 必須 | first-row-id | long | 最初のマニフェストの最初のデータファイルの最初の行に割り当てられる_row_id |
|  |  | オプション | key-id | string | マニフェストリストキーメタデータを暗号化する暗号化キーのID |
### スナップショット参照（refs）オブジェクト
| v1 | v2 | v3 | フィールド | 型 | 説明 |
|:---:|:---:|:---:|:------------|:---|:-----|
| 必須 | 必須 | 必須 | snapshot-id | long | 参照するスナップショットのID |
| 必須 | 必須 | 必須 | type | string | 参照タイプ（"branch" または "tag"） |
| オプション | オプション | オプション | min-snapshots-to-keep | integer | ブランチで保持する最小スナップショット数（ブランチのみ） |
| オプション | オプション | オプション | max-snapshot-age-ms | long | 保持するスナップショットの最大経過時間（ブランチのみ） |
| オプション | オプション | オプション | max-ref-age-ms | long | 参照を保持する最大経過時間（mainブランチ以外） |
### 統計（statistics）オブジェクト
#### テーブル統計
| v1 | v2 | v3 | フィールド | 型 | 説明 |
|:---:|:---:|:---:|:------------|:---|:-----|
| 必須 | 必須 | 必須 | snapshot-id | long | 統計が関連付けられているスナップショットID |
| 必須 | 必須 | 必須 | statistics-path | string | Puffinファイルのパス |
| 必須 | 必須 | 必須 | file-size-in-bytes | long | Puffinファイルのサイズ |
| 必須 | 必須 | 必須 | file-footer-size-in-bytes | long | Puffinファイルフッターの総サイズ |
| オプション | オプション | オプション | key-metadata | string | 暗号化用のキーメタデータ（Base64エンコード） |
| 必須 | 必須 | 必須 | blob-metadata | list<blob-metadata> | ファイル内の統計のblobメタデータリスト |
#### パーティション統計
| v1 | v2 | v3 | フィールド | 型 | 説明 |
|:---:|:---:|:---:|:------------|:---|:-----|
| 必須 | 必須 | 必須 | snapshot-id | long | パーティション統計ファイルが関連付けられているスナップショットID |
| 必須 | 必須 | 必須 | statistics-path | string | パーティション統計ファイルのパス |
| 必須 | 必須 | 必須 | file-size-in-bytes | long | パーティション統計ファイルのサイズ（バイト単位） |
### 暗号化キー（encryption-keys）オブジェクト
| v3 | フィールド | 型 | 説明 |
|:---:|:------------|:---|:-----|
| 必須 | key-id | string | 暗号化キーのID |
| 必須 | encrypted-key-metadata | string | 暗号化されたキーとメタデータ（Base64エンコード） |
| オプション | encrypted-by-id | string | key-metadataの暗号化に使用されたキーのID |
| オプション | properties | map<string, string> | テーブルの暗号化スキームで使用される追加メタデータ |

## マニフェストリストのフィールドと関連オブジェクト
### マニフェストリストのフィールド
| v1 | v2 | v3 | フィールド (ID) | 型 | 説明 |
|:---:|:---:|:---:|:---------------------------|:---------------|:------------------------------------------------------------------------------------------------------------------------|
| 必須 | 必須 | 必須 | manifest_path (500) | string | マニフェストファイルのパス |
| 必須 | 必須 | 必須 | manifest_length (501) | long | マニフェストファイルのバイト長 |
| 必須 | 必須 | 必須 | partition_spec_id (502) | int | マニフェストファイルを作成したときのパーティション仕様ID。テーブルの `partition-specs` に定義されるIDと対応する |
|  | 必須 | 必須 | content (517) | int (0 or 1) | ファイルの種類を表す。<br>0: データファイル<br>1: 削除ファイル<br>v1では常に0扱い |
|  | 必須 | 必須 | sequence_number (515) | long | マニフェストがテーブルに追加された際のシーケンス番号。v1の場合は読み取り時に0を使う |
|  | 必須 | 必須 | min_sequence_number (516) | long | マニフェスト内の有効なデータまたは削除ファイルが持つ最小シーケンス番号。v1の場合は読み取り時に0を使う |
| 必須 | 必須 | 必須 | added_snapshot_id (503) | long | マニフェストがテーブルに追加されたスナップショットのID |
| オプション | 必須 | 必須 | added_files_count (504) | int | マニフェスト内で「新規追加(ADDED)」として扱われるファイル数 |
| オプション | 必須 | 必須 | existing_files_count (505) | int | マニフェスト内で「既存(EXISTING)」として扱われるファイル数 |
| オプション | 必須 | 必須 | deleted_files_count (506) | int | マニフェスト内で「削除(DELETED)」として扱われるファイル数 |
| オプション | 必須 | 必須 | added_rows_count (512) | long | ADDEDファイルに含まれる行数 |
| オプション | 必須 | 必須 | existing_rows_count (513) | long | EXISTINGファイルに含まれる行数 |
| オプション | 必須 | 必須 | deleted_rows_count (514) | long | DELETEDファイルに含まれる行数 |
| オプション | オプション | オプション | partitions (507) | list<field_summary> | マニフェストが管理する各パーティションフィールドの要約情報 |
| オプション | オプション | オプション | key_metadata (519) | binary | 暗号化に使用される実装固有のメタデータ |
|  |  | オプション | first_row_id (520) | long / null | v3の新機能(行リネージ有効時)。マニフェストが管理する「ADDEDデータファイル」の行ID割り当て開始値。削除ファイルや既存ファイルにはnullが入る |

### フィールドサマリー（field_summary）構造

`partitions` フィールドは、マニフェストで使用されるパーティション仕様に含まれる各フィールドに対する要約情報をリストとして格納する。

| v1 | v2 | v3 | フィールド (ID) | 型 | 説明 |
|:---:|:---:|:---:|:------------------|:--------|:------------------------------------------------------------------------------------------------------|
| 必須 | 必須 | 必須 | contains_null (509) | boolean | パーティションの値にnullが含まれているか |
| オプション | オプション | オプション | contains_nan (518) | boolean | パーティションの値にNaNが含まれているか |
| オプション | オプション | オプション | lower_bound (510) | bytes | 非null/NaNの最小値（シングルオブジェクト形式でバイナリシリアライズ）。すべてがnull/NaNの場合はnull |
| オプション | オプション | オプション | upper_bound (511) | bytes | 非null/NaNの最大値（シングルオブジェクト形式でバイナリシリアライズ）。すべてがnull/NaNの場合はnull |

## マニフェストファイルのフィールドと関連オブジェクト
### マニフェストエントリ（manifest_entry）のフィールド

| v1 | v2 | v3 | フィールド (ID) | 型 | 説明 |
|:---:|:---:|:---:|:------------------------|:---------|:---------------------------------------------------------------------------------------------|
| 必須 | 必須 | 必須 | status (0) | int | ファイルのステータス：<br>0: EXISTING（既存）<br>1: ADDED（追加）<br>2: DELETED（削除） |
| 必須 | オプション | オプション | snapshot_id (1) | long | ファイルが追加・削除されたスナップショットのID。v2ではマニフェストファイルのメタデータから継承される場合はnull可 |
|  | オプション | オプション | sequence_number (3) | long | データの論理的な順序を表すシーケンス番号。nullの場合は継承される |
|  | オプション | オプション | file_sequence_number (4) | long | ファイルがテーブルに追加されたスナップショットのシーケンス番号。nullの場合は継承される |
| 必須 | 必須 | 必須 | data_file (2) | struct | データファイル構造体（詳細は後述） |

### データファイル（data_file）構造体のフィールド

| v1 | v2 | v3 | フィールド (ID) | 型 | 説明 |
|:---:|:---:|:---:|:-------------------------|:---------|:------------------------------------------------------------------------------------------------------------------------|
|  | 必須 | 必須 | content (134) | int (0: DATA, 1: POSITION DELETES, 2: EQUALITY DELETES) | ファイルの種別：データ、等価削除、位置削除（v1ファイルはすべてデータファイル） |
| 必須 | 必須 | 必須 | file_path (100) | string | ファイルの完全URI（FSスキーム付き） |
| 必須 | 必須 | 必須 | file_format (101) | string | ファイルフォーマット名（avro、orc、parquet、puffin） |
| 必須 | 必須 | 必須 | partition (102) | struct<...> | パーティションデータタプル。パーティション仕様の出力に基づくスキーマで、構造体フィールドIDにパーティションフィールドIDを使用 |
| 必須 | 必須 | 必須 | record_count (103) | long | ファイル内のレコード数、または削除ベクターのカーディナリティ |
| 必須 | 必須 | 必須 | file_size_in_bytes (104) | long | ファイルの総サイズ（バイト） |
| 必須 |  |  | block_size_in_bytes (105) | long | 非推奨。v1では常にデフォルト値を書き込む。v2またはv3では書き込まない |
| オプション |  |  | file_ordinal (106) | int | 非推奨。書き込まない |
| オプション |  |  | sort_columns (107) | list<112: int> | 非推奨。書き込まない |
| オプション | オプション | オプション | column_sizes (108) | map<117: int, 118: long> | 列IDから、その列を格納するすべての領域のディスク上の総サイズへのマップ。フッターなど他の列を読むために必要なバイトは含まない。行指向フォーマット（Avro）の場合はnull |
| オプション | オプション | オプション | value_counts (109) | map<119: int, 120: long> | 列IDから列内の値数（nullとNaN値を含む）へのマップ |
| オプション | オプション | オプション | null_value_counts (110) | map<121: int, 122: long> | 列IDから列内のnull値数へのマップ |
| オプション | オプション | オプション | nan_value_counts (137) | map<138: int, 139: long> | 列IDから列内のNaN値数へのマップ |
| オプション | オプション |  | distinct_counts (111) | map<123: int, 124: long> | 非推奨。書き込まない |
| オプション | オプション | オプション | lower_bounds (125) | map<126: int, 127: binary> | 列IDからバイナリとしてシリアライズされた列の下限値へのマップ。各値はファイル内の列のすべての非null、非NaN値以下である必要がある |
| オプション | オプション | オプション | upper_bounds (128) | map<129: int, 130: binary> | 列IDからバイナリとしてシリアライズされた列の上限値へのマップ。各値はファイル内の列のすべての非null、非NaN値以上である必要がある |
| オプション | オプション | オプション | key_metadata (131) | binary | 暗号化用の実装固有キーメタデータ |
| オプション | オプション | オプション | split_offsets (132) | list<133: long> | データファイルの分割オフセット。例：Parquetファイルのすべての行グループオフセット。昇順ソート必須 |
|  | オプション | オプション | equality_ids (135) | list<136: int> | 等価削除ファイルで行の等価性判定に使用されるフィールドID。content=2の場合は必須、それ以外はnull。この列にリストされたIDを持つフィールドは削除ファイルに存在する必要がある |
| オプション | オプション | オプション | sort_order_id (140) | int | このファイルのソート順を表すID |
|  |  | オプション | first_row_id (142) | long | データファイルの最初の行の_row_id。行ID継承を参照 |
|  | オプション | オプション | referenced_data_file (143) | string | すべての削除が参照するデータファイルの完全修飾場所（FSスキーム付きURI） |
|  |  | オプション | content_offset (144) | long | ファイル内でコンテンツが開始するオフセット |
|  |  | オプション | content_size_in_bytes (145) | long | ファイルに格納された参照コンテンツの長さ。content_offsetが存在する場合は必須 |

### マニフェストファイルのメタデータ（Avroキー値メタデータ）
マニフェストファイル自体はAvroファイルで、そのファイルヘッダーのkey-valueメタデータセクションに以下の情報が格納される。

| v1 | v2 | v3 | キー | 値の型 | 説明 |
|:---:|:---:|:---:|:-----|:-------|:-----|
| 必須 | 必須 | 必須 | schema | JSON string | マニフェスト作成時のテーブルスキーマのJSON表現 |
| オプション | 必須 | 必須 | schema-id | string | マニフェスト作成に使用されたスキーマのID |
| 必須 | 必須 | 必須 | partition-spec | JSON string | マニフェスト作成に使用されたパーティション仕様のJSON表現 |
| オプション | 必須 | 必須 | partition-spec-id | string | マニフェスト作成に使用されたパーティション仕様のID |
| オプション | 必須 | 必須 | format-version | string | マニフェストのテーブルフォーマットバージョン番号 |
|  | 必須 | 必須 | content | string | マニフェストが追跡するファイルタイプ（"data" または "deletes"） |

## ビューメタデータファイルのフィールドと関連オブジェクト

### ビューメタデータファイルの主要フィールド

| 要件 | フィールド名 | 型 | 説明 |
|:---:|:------------|:---|:-----|
| 必須 | view-uuid | UUID | ビュー作成時に生成される一意のUUID。メタデータ更新後、ビューのUUIDが期待されるUUIDと一致しない場合、実装は例外をスローする必要がある |
| 必須 | format-version | integer | ビューフォーマットのバージョン番号。1である必要がある |
| 必須 | location | string | ビューのベースロケーション。メタデータファイルの場所を作成するために使用される |
| 必須 | schemas | list<schema> | 既知のスキーマのリスト |
| 必須 | current-version-id | integer | ビューの現在のバージョンのID（version-id） |
| 必須 | versions | list<version> | ビューの既知のバージョンのリスト |
| 必須 | version-log | list<log_entry> | current-version-idへのすべての変更に対するタイムスタンプとversion-idを含むバージョンログエントリのリスト |
| オプション | properties | map<string, string> | ビューのプロパティの文字列マップ |

### バージョン（versions）オブジェクト

各バージョンは以下のフィールドを持つ。

| 要件 | フィールド名 | 型 | 説明 |
|:---:|:------------|:---|:-----|
| 必須 | version-id | integer | バージョンのID |
| 必須 | schema-id | integer | ビューバージョンのスキーマID |
| 必須 | timestamp-ms | long | バージョンが作成されたタイムスタンプ（エポックからのミリ秒） |
| 必須 | summary | map<string, string> | バージョンに関するサマリーメタデータの文字列マップ |
| 必須 | representations | list<representation> | ビュー定義の表現のリスト |
| オプション | default-catalog | string | SELECT内の参照がカタログを含まない場合に使用するカタログ名 |
| 必須 | default-namespace | list<string> | SELECT内の参照が単一識別子の場合に使用するネームスペース |

### サマリー（summary）メタデータ

バージョンのサマリーで使用される一般的なメタデータキー。

| 要件 | キー | 値の説明 |
|:---:|:-----|:---------|
| オプション | engine-name | ビューバージョンを作成したエンジンの名前 |
| オプション | engine-version | ビューバージョンを作成したエンジンのバージョン |

### 表現（representations）オブジェクト

#### SQL表現（SQL representation）

| 要件 | フィールド名 | 型 | 説明 |
|:---:|:------------|:---|:-----|
| 必須 | type | string | "sql"である必要がある |
| 必須 | sql | string | ビューを定義するSQL SELECT文 |
| 必須 | dialect | string | SQL SELECT文の方言（例："trino"、"spark"） |

### バージョンログ（version-log）エントリ

各エントリは以下のフィールドを持つ構造体。

| 要件 | フィールド名 | 型 | 説明 |
|:---:|:------------|:---|:-----|
| 必須 | timestamp-ms | long | ビューのcurrent-version-idが更新されたタイムスタンプ（エポックからのミリ秒） |
| 必須 | version-id | integer | current-version-idに設定されたID |

### スキーマ（schemas）オブジェクト

ビューのスキーマはテーブルのスキーマと同じ構造を使用する。

| 要件 | フィールド名 | 型 | 説明 |
|:---:|:------------|:---|:-----|
| 必須 | schema-id | integer | スキーマを識別する一意のID |
| 必須 | type | string | "struct" |
| 必須 | fields | list<field> | フィールドのリスト |

#### フィールド（field）構造

| 要件 | フィールド名 | 型 | 説明 |
|:---:|:------------|:---|:-----|
| 必須 | id | integer | フィールドの一意のID |
| 必須 | name | string | フィールド名 |
| 必須 | required | boolean | フィールドが必須かどうか |
| 必須 | type | string | フィールドのデータ型 |
| オプション | doc | string | フィールドのドキュメント/コメント |
